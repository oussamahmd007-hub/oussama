<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OUSSOCASH | Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <style>
        :root {
            /* Ø£Ù„ÙˆØ§Ù† Ù‡Ø§Ø¯Ø¦Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ© */
            --bg-color: #F3F4F6;
            --surface-color: #FFFFFF;
            --primary-text: #1F2937;
            --secondary-text: #6B7280;
            --accent-gold: #C5A059;
            --accent-gold-soft: #F9F5EB;
            --border-light: #E5E7EB;
            --success-green: #10B981;
            --danger-red: #EF4444;
            --danger-soft: #FEF2F2;
            --radius-md: 16px;
            --radius-xl: 24px;
            --shadow-soft: 0 10px 40px -10px rgba(0,0,0,0.06);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px 10px;
            color: var(--primary-text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 440px;
            background: var(--surface-color);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            position: relative;
            border: 1px solid white;
        }

        .header { padding: 35px 25px 20px; text-align: center; }
        .brand-name {
            font-size: 26px; font-weight: 800; letter-spacing: 1px; margin: 0;
            background: linear-gradient(135deg, #1F2937 0%, #4B5563 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .brand-tag { font-size: 12px; color: var(--accent-gold); font-weight: 600; letter-spacing: 2px; margin-top: 5px; text-transform: uppercase; }

        .nav-pill-container {
            display: flex; background: #F9FAFB; margin: 0 20px; padding: 5px; border-radius: 20px; border: 1px solid var(--border-light);
        }
        .nav-item {
            flex: 1; text-align: center; padding: 10px 0; font-size: 12px; font-weight: 600; color: var(--secondary-text);
            cursor: pointer; z-index: 2; transition: color 0.3s ease; border-radius: 15px;
        }
        .nav-item.active { background: var(--surface-color); color: var(--primary-text); box-shadow: 0 2px 8px rgba(0,0,0,0.05); font-weight: 700; }

        .content-area { padding: 30px 20px; }
        .input-group { margin-bottom: 15px; }
        
        input, select {
            width: 100%; padding: 16px 20px; border: 1px solid var(--border-light); border-radius: var(--radius-md);
            font-family: 'Cairo'; font-size: 14px; background: #FAFAFA; transition: all 0.2s ease; outline: none;
        }
        input:focus, select:focus { border-color: var(--accent-gold); background: var(--surface-color); box-shadow: 0 0 0 3px rgba(197, 160, 89, 0.1); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ­Ø°ÙŠØ± (Ø§Ù„Ø³Ø­Ø¨) */
        .warning-banner {
            background-color: var(--danger-soft); border: 1px solid #FCA5A5; color: #991B1B;
            padding: 15px; border-radius: var(--radius-md); font-size: 13px; line-height: 1.6;
            margin-bottom: 20px; display: flex; align-items: start; gap: 10px;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø© (Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹) */
        .wallet-card {
            background: var(--accent-gold-soft); border: 1px dashed var(--accent-gold); border-radius: var(--radius-md);
            padding: 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;
        }
        .wallet-number { font-weight: 800; font-size: 18px; letter-spacing: 1px; color: var(--primary-text); }
        .btn-copy { background: transparent; color: var(--accent-gold); border: none; font-weight: 700; font-size: 13px; cursor: pointer; }

        /* Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù */
        .file-upload {
            border: 1px solid var(--border-light); background: white; padding: 12px; border-radius: var(--radius-md);
            display: flex; align-items: center; gap: 10px; cursor: pointer; transition: 0.3s;
        }
        .file-upload:hover { border-color: var(--accent-gold); }
        .file-icon { width: 40px; height: 40px; background: var(--bg-color); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .file-label { font-size: 13px; color: var(--secondary-text); font-weight: 600; flex: 1; }
        #preview-img { width: 100%; border-radius: 10px; margin-top: 10px; display: none; object-fit: cover; height: 140px; border: 1px solid var(--border-light); }

        .btn-primary {
            width: 100%; padding: 18px; background: var(--primary-text); color: white; border: none;
            border-radius: var(--radius-md); font-weight: 700; font-size: 15px; cursor: pointer;
            box-shadow: 0 4px 15px rgba(31, 41, 55, 0.2); transition: transform 0.2s, background 0.3s;
        }
        .btn-primary:active { transform: scale(0.98); }
        .btn-primary:disabled { opacity: 0.7; cursor: not-allowed; background: #9CA3AF; }

        /* Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© */
        .help-header { margin-bottom: 20px; }
        .help-title { font-size: 18px; font-weight: 800; margin-bottom: 5px; }
        .help-subtitle { font-size: 13px; color: var(--secondary-text); }
        .faq-card { background: var(--surface-color); border: 1px solid var(--border-light); border-radius: var(--radius-md); margin-bottom: 12px; overflow: hidden; transition: 0.3s; }
        .faq-head { padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-weight: 700; font-size: 14px; }
        .faq-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: #FAFAFA; }
        .faq-content { padding: 0 20px 20px; font-size: 13px; color: var(--secondary-text); line-height: 1.6; }
        .faq-card.open .faq-body { max-height: 200px; }

        /* Ø§Ù„Ø¯Ø¹Ù… */
        .support-action { margin-top: 30px; text-align: center; background: #F0FDF4; padding: 20px; border-radius: var(--radius-md); border: 1px solid #DCFCE7; }
        .btn-whatsapp { display: inline-flex; align-items: center; gap: 10px; background: #10B981; color: white; text-decoration: none; padding: 12px 25px; border-radius: 50px; font-weight: 700; font-size: 14px; }

        .hidden { display: none; }
        #toast { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%) translateY(20px); background: var(--primary-text); color: white; padding: 12px 30px; border-radius: 50px; font-size: 13px; font-weight: 600; opacity: 0; pointer-events: none; transition: 0.4s; z-index: 999; }
        #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-card { background: white; padding: 40px 30px; border-radius: 30px; text-align: center; width: 85%; max-width: 320px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div id="toast">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</div>

<div class="modal-overlay" id="successModal">
    <div class="modal-card">
        <div style="font-size: 48px; margin-bottom: 15px;">ğŸš€</div>
        <h3 style="margin: 0 0 10px; color: var(--primary-text);">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­</h3>
        <p style="color: var(--secondary-text); font-size: 14px; line-height: 1.5; margin-bottom: 25px;">Ø·Ù„Ø¨Ùƒ ÙˆØµÙ„ Ø¥Ù„ÙŠÙ†Ø§ ÙˆØ³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ ÙÙˆØ±Ø§Ù‹.</p>
        <button class="btn-primary" onclick="closeModal()">Ø­Ø³Ù†Ø§Ù‹ØŒ Ø´ÙƒØ±Ø§Ù‹</button>
    </div>
</div>

<div class="app-container">
    <div class="header">
        <h1 class="brand-name">OUSSOCASH</h1>
        <div class="brand-tag">Premium Finance</div>
    </div>

    <div class="nav-pill-container">
        <div class="nav-item active" onclick="switchTab('trade', this)">Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
        <div class="nav-item" onclick="switchTab('status', this)">Ø·Ù„Ø¨Ø§ØªÙŠ</div>
        <div class="nav-item" onclick="switchTab('help', this)">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</div>
        <div class="nav-item" onclick="switchTab('about', this)">Ø¹Ù† Ø§Ù„ÙˆÙƒØ§Ù„Ø©</div>
    </div>

    <div class="content-area">
        
        <div id="trade">
            <div class="input-group">
                <select id="opType" onchange="toggleForm()">
                    <option value="deposit">Ø¥ÙŠØ¯Ø§Ø¹ (Ø´Ø­Ù† Ø±ØµÙŠØ¯)</option>
                    <option value="withdraw">Ø³Ø­Ø¨ (Ø§Ø³ØªÙ„Ø§Ù… ÙƒØ§Ø´)</option>
                </select>
            </div>

            <div id="depositSection">
                <div class="input-group">
                    <select id="depositBank" onchange="updateWalletInfo()">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù†Ùƒ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</option>
                        <option value="49543135">Ø¨Ù†ÙƒÙŠÙ„ÙŠ - Bankily</option>
                        <option value="49543135">Ù…ØµØ±ÙÙŠ - Masrivi</option>
                        <option value="49543135">Ø³Ø¯Ø§Ø¯ - Sedad</option>
                        <option value="49543135">Ø¨ÙŠÙ… Ø¨Ù†Ùƒ - BIM Bank</option>
                    </select>
                </div>

                <div id="walletDisplay" class="hidden">
                    <div class="wallet-card">
                        <div>
                            <div style="font-size: 10px; color: var(--secondary-text); font-weight: 700;">Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©</div>
                            <div class="wallet-number" id="walletNum">49543135</div>
                        </div>
                        <button class="btn-copy" onclick="copyWallet()">Ù†Ø³Ø®</button>
                    </div>

                    <div class="input-group" onclick="document.getElementById('fileInput').click()">
                        <div class="file-upload">
                            <div class="file-icon">ğŸ“</div>
                            <div class="file-label">Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø§Ø¶ØºØ· Ù‡Ù†Ø§)</div>
                        </div>
                        <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="previewFile(this)">
                        <img id="preview-img" src="">
                    </div>
                </div>
            </div>

            <div id="withdrawSection" class="hidden">
                <div class="warning-banner">
                    <span style="font-size: 18px;">âš ï¸</span>
                    <div>
                        <strong>ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…!</strong>
                        <br>ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆÙƒØ§Ù„Ø©: Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ø´Ø§Ø±Ø¹ OUSSOCASH.
                    </div>
                </div>
                <div class="input-group">
                    <select id="withdrawBank">
                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø³ØªÙ„Ù… --</option>
                        <option value="Bankily">Ø¨Ù†ÙƒÙŠÙ„ÙŠ - Bankily</option>
                        <option value="Masrivi">Ù…ØµØ±ÙÙŠ - Masrivi</option>
                        <option value="Sedad">Ø³Ø¯Ø§Ø¯ - Sedad</option>
                        <option value="BIM Bank">Ø¨ÙŠÙ… Ø¨Ù†Ùƒ - BIM Bank</option>
                    </select>
                </div>
                <div class="input-group">
                    <input type="text" id="withdrawCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ">
                </div>
            </div>

            <div class="input-group">
                <input type="text" id="accId" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ (ID)">
            </div>
            <div class="input-group" style="display: flex; gap: 10px;">
                <input type="number" id="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" style="flex:1">
                <input type="number" id="phone" placeholder="Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ" style="flex:1">
            </div>

            <button class="btn-primary" id="submitBtn" onclick="processOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
        </div>

        <div id="help" class="hidden">
            <div class="help-header">
                <div class="help-title">Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</div>
                <div class="help-subtitle">Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ</div>
            </div>
            <div class="faq-card" onclick="this.classList.toggle('open')"><div class="faq-head">ÙƒÙ… ØªØ³ØªØºØ±Ù‚ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ <span>+</span></div><div class="faq-body"><div class="faq-content">Ø®Ù„Ø§Ù„ 2 - 10 Ø¯Ù‚Ø§Ø¦Ù‚ ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰.</div></div></div>
            <div class="faq-card" onclick="this.classList.toggle('open')"><div class="faq-head">Ø£Ø®Ø·Ø£Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ <span>+</span></div><div class="faq-body"><div class="faq-content">ØªÙˆØ§ØµÙ„ ÙÙˆØ±Ø§Ù‹ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨.</div></div></div>
            <div class="support-action">
                <div style="font-size:13px; color:#166534; margin-bottom:15px; font-weight:600;">Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ©ØŸ</div>
                <a href="https://wa.me/22249543135" class="btn-whatsapp">ØªØ­Ø¯Ø« Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</a>
            </div>
        </div>

        <div id="status" class="hidden">
            <div id="ordersList" style="text-align: center; color: var(--secondary-text); font-size: 13px; margin-top: 40px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„...</div>
        </div>

        <div id="about" class="hidden">
            <h3 style="color: var(--primary-text);">OUSSOCASH</h3>
            <p style="color: var(--secondary-text); line-height: 1.6; font-size: 14px;">Ø§Ù„Ø³Ø±Ø¹Ø©ØŒ Ø§Ù„Ø£Ù…Ø§Ù†ØŒ ÙˆØ§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ© Ù‡ÙŠ Ø´Ø¹Ø§Ø±Ù†Ø§. Ù†Ø³Ø¹Ù‰ Ù„ØªÙ‚Ø¯ÙŠÙ… Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø© Ù…Ø§Ù„ÙŠØ© Ø±Ù‚Ù…ÙŠØ©.</p>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = { 
        databaseURL: "https://oussocash-default-rtdb.firebaseio.com",
        storageBucket: "oussocash-default-rtdb.appspot.com" 
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const storage = firebase.storage();

    function switchTab(id, btn) {
        document.querySelectorAll('.content-area > div').forEach(d => d.classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.remove('hidden');
        btn.classList.add('active');
        if(id === 'status') loadOrders();
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg; t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }

    function toggleForm() {
        const type = document.getElementById('opType').value;
        document.getElementById('depositSection').classList.toggle('hidden', type === 'withdraw');
        document.getElementById('withdrawSection').classList.toggle('hidden', type === 'deposit');
    }

    function updateWalletInfo() {
        const val = document.getElementById('depositBank').value;
        const display = document.getElementById('walletDisplay');
        if(val) {
            document.getElementById('walletNum').innerText = val;
            display.classList.remove('hidden');
        } else {
            display.classList.add('hidden');
        }
    }

    function copyWallet() {
        navigator.clipboard.writeText(document.getElementById('walletNum').innerText);
        showToast("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…");
    }

    function previewFile(input) {
        const preview = document.getElementById('preview-img');
        const file = input.files[0];
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (Ù…Ø«Ù„Ø§Ù‹ 5 Ù…ÙŠØ¬Ø§)
        if(file && file.size > 5 * 1024 * 1024) {
            alert("Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£Ù‚Ù„ Ù…Ù† 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª");
            input.value = ""; // Ù…Ø³Ø­ Ø§Ù„Ù…Ù„Ù
            return;
        }

        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => { preview.src = e.target.result; preview.style.display = 'block'; }
            reader.readAsDataURL(file);
        }
    }

    function closeModal() {
        document.getElementById('successModal').style.display = 'none';
        switchTab('status', document.querySelectorAll('.nav-item')[1]);
    }

    async function processOrder() {
        const type = document.getElementById('opType').value;
        const id = document.getElementById('accId').value;
        const amt = document.getElementById('amount').value;
        const ph = document.getElementById('phone').value;
        const file = document.getElementById('fileInput').files[0];
        const code = document.getElementById('withdrawCode').value;
        const withdrawBank = document.getElementById('withdrawBank').value;

        if(!id || !amt || !ph) return showToast("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        
        if(type === 'deposit') {
            if(!file) return showToast("ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ø·Ù„ÙˆØ¨Ø©");
        }
        if(type === 'withdraw') {
            if(!withdrawBank) return showToast("Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø³ØªÙ„Ù…");
            if(!code) return showToast("ÙƒÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨ Ù…Ø·Ù„ÙˆØ¨");
        }

        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        
        // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ù„ÙŠØ¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
        btn.innerText = (type === 'deposit') ? "Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©..." : "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";

        try {
            let imgUrl = "-";
            let bankName = "";

            if(type === 'deposit') {
                const depSelect = document.getElementById('depositBank');
                bankName = depSelect.options[depSelect.selectedIndex].text;

                // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©
                const ref = storage.ref(`receipts/${Date.now()}_${ph}`);
                await ref.put(file);
                btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."; // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
                imgUrl = await ref.getDownloadURL();
            } else {
                bankName = withdrawBank;
            }

            await db.ref('orders').push({
                Ø§Ù„Ù†ÙˆØ¹: type === 'deposit' ? 'Ø¥ÙŠØ¯Ø§Ø¹' : 'Ø³Ø­Ø¨',
                Ø§Ù„Ø¨Ù†Ùƒ: bankName,
                Ø§Ù„Ù…Ø¨Ù„Øº: amt, Ø§Ù„Ø¢ÙŠØ¯ÙŠ: id, Ø§Ù„Ù‡Ø§ØªÙ: ph,
                ÙƒÙˆØ¯_Ø§Ù„Ø³Ø­Ø¨: code || '-', Ø§Ù„Ø¥Ø«Ø¨Ø§Øª: imgUrl,
                Ø§Ù„Ø­Ø§Ù„Ø©: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                Ø§Ù„ØªÙˆÙ‚ÙŠØª: new Date().toLocaleString('ar-SA')
            });

            localStorage.setItem('userPhone', ph);
            document.getElementById('successModal').style.display = 'flex';
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ù‚ÙˆÙ„
            document.getElementById('amount').value = '';
            document.getElementById('accId').value = '';
            if(type === 'withdraw') document.getElementById('withdrawCode').value = '';
            
        } catch (e) {
            console.error(e);
            showToast("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹");
        } finally {
            btn.disabled = false;
            btn.innerText = "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©";
        }
    }

    function loadOrders() {
        const ph = localStorage.getItem('userPhone');
        const list = document.getElementById('ordersList');
        if(!ph) {
            list.innerHTML = '<p style="text-align:center; color:gray; font-size:12px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©</p>';
            return;
        }

        db.ref('orders').orderByChild('Ø§Ù„Ù‡Ø§ØªÙ').equalTo(ph).limitToLast(5).on('value', snap => {
            list.innerHTML = '';
            if(!snap.exists()) {
                list.innerHTML = '<p style="text-align:center; color:gray; font-size:12px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©</p>';
                return;
            }
            const orders = [];
            snap.forEach(c => orders.push(c.val()));
            orders.reverse().forEach(o => {
                const statusColor = o.Ø§Ù„Ø­Ø§Ù„Ø© === 'Ù…ÙƒØªÙ…Ù„' ? '#10B981' : (o.Ø§Ù„Ø­Ø§Ù„Ø© === 'Ù…Ø±ÙÙˆØ¶' ? '#EF4444' : '#F59E0B');
                list.innerHTML += `
                    <div style="background: #FAFAFA; border: 1px solid #E5E7EB; border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 700; font-size: 14px; color: var(--primary-text);">${o.Ø§Ù„Ù†ÙˆØ¹} - ${o.Ø§Ù„Ù…Ø¨Ù„Øº}</div>
                            <div style="font-size: 11px; color: var(--secondary-text); margin-top: 4px;">${o.Ø§Ù„ØªÙˆÙ‚ÙŠØª}</div>
                        </div>
                        <span style="font-size: 11px; font-weight: 700; color: ${statusColor}; background: ${statusColor}15; padding: 4px 10px; border-radius: 20px;">${o.Ø§Ù„Ø­Ø§Ù„Ø©}</span>
                    </div>
                `;
            });
        });
    }
</script>
</body>
</html>
